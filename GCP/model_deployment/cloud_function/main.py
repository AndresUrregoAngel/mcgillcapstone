from googleapiclient import discovery
from googleapiclient import errors




def predict_json(project, model, version):

    service = discovery.build('ml', 'v1')
    name = 'projects/{}/models/{}'.format(project, model)

    if version is not None:
        name += '/versions/{}'.format(version)

    response = service.projects().predict(
        name=name,
        body={'instances': [ 
            [1,0,3,1,0,0,0,9887.436470999999,6121.641189,1.862091964,297.99059589999996,14024.88956,36377.03625,243.17949,986.7456426000001,3051.3494579999997,31835.325760000003,259.3440741,7.2406073939999995,34997.04688,7809.794457999999,3940.237472,1996.923893,1958.7290699999999,4.170176274,46217.158189999995,4486.262922999999,543273.2239999999,82393.30799,2.25833333333333,1938.15,286.26833333333303,645.774166666667]
# [1,0,0,0,0,0,0,6469.666791,10690.99538,2.539517634,3688.283093,6883.880504000001,22503.43172,1858.13807,1577.823199,3472.0966340000004,15495.38041,102.2379495,28.72303195,17423.58797,5884.128186,3031.028302,2371.207964,4394.000384,5.487145845,30861.27693,2242.420787,646913.1866,121814.9549,1.925,1959.85,511.7,376.175],
# [0,0,0,0,0,9,0,4078.15498,7083.510963,2.58812417,2722.287183,6102.733783,10575.71965,1535.243153,1436.242901,1465.2826009999999,6116.390209,21.17965579,21.17965579,9508.217193999999,3370.045485,1911.513336,1569.59511,3064.439277,5.793520491000001,18118.2333,1303.6667630000002,714749.5836,140334.3714,2.0,1998.55,771.025,240.375],
# [0,0,54,3,0,1,0,8741.141317,4775.396096,1.861391019,303.37296580000003,17356.335069999997,26633.72388,302.6235808,936.9719827,1500.651592,23741.96849,152.7264943,3.42665533,32064.119860000003,6146.153814,2987.1165109999997,1532.191341,1560.899752,4.204911688,40573.5825,3718.74514,637441.0314,102553.8556,2.83,1892.05,301.905,1100.635],
# [0,0,9,3,0,0,0,3729.8900439999998,5733.225242,2.529629924,8181.612956,1583.3190539999998,5560.478058,742.8272107999999,1682.9439300000001,123.9332206,3002.502621,5.564472162,1.728923496,4085.617387,1877.1616760000002,1930.434693,2162.396677,5272.119312,6.37670567,14274.58706,1049.1789390000001,407728.0745,96831.61709,1.3,1990.65,442.625,123.1]

        ]}
    ).execute()

    if 'error' in response:
        raise RuntimeError(response['error'])

    print(response['predictions'])

    return response['predictions']



def launch_prediction(request):
    res = predict_json('mcgillcapstone', 'historicalrisk', version='historicalriskml')
    
    for i in res:
        if i == 0 :
            return 'The zone does not present risk of fire event'
        else:
            return 'The zone is vulnerable to a fire event'
        
    #return message
